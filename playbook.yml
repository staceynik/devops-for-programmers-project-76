- name: Main playbook
  hosts: all
  become: true

  tasks:
    - name: Install pip
      pip:
        name: requests
        state: present
      tags:
        - install_pip

- name: Prepare Python and Install Docker
  hosts: all
  become: true

  roles:
    - geerlingguy.pip
  tags:
    - install_pip

- name: Install Docker on webservers
  hosts: webservers
  become: true
  roles:
    - geerlingguy.docker
  tags:
    - install_docker

- name: Configure datadog on webservers
  hosts: webservers
  become: true
  roles:
    - datadog.datadog
  tags:
    - configure_datadog

- name: Deploy Redmine on webservers
  hosts: webservers
  become: true
  roles:
    - deploy_redmine
  tags:
    - deploy_redmine
